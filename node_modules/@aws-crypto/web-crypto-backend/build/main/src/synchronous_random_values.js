"use strict";
// Copyright Amazon.com Inc. or its affiliates. All Rights Reserved.
// SPDX-License-Identifier: Apache-2.0
Object.defineProperty(exports, "__esModule", { value: true });
exports.generateSynchronousRandomValues = exports.synchronousRandomValues = void 0;
const ie11_detection_1 = require("@aws-crypto/ie11-detection");
const supports_web_crypto_1 = require("@aws-crypto/supports-web-crypto");
const util_locate_window_1 = require("@aws-sdk/util-locate-window");
/* There are uses for a synchronous random source.
 * For example constructors need to be synchronous.
 * The AWS JS SDK uses IRandomValues to have a consistent interface.
 */
exports.synchronousRandomValues = generateSynchronousRandomValues((0, util_locate_window_1.locateWindow)());
function generateSynchronousRandomValues(globalScope) {
    return function synchronousRandomValues(byteLength) {
        if ((0, supports_web_crypto_1.supportsSecureRandom)(globalScope)) {
            return globalScope.crypto.getRandomValues(new Uint8Array(byteLength));
        }
        else if ((0, ie11_detection_1.isMsWindow)(globalScope)) {
            const values = new Uint8Array(byteLength);
            globalScope.msCrypto.getRandomValues(values);
            return values;
        }
        throw new Error(`Unable to locate a secure random source.`);
    };
}
exports.generateSynchronousRandomValues = generateSynchronousRandomValues;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3luY2hyb25vdXNfcmFuZG9tX3ZhbHVlcy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9zeW5jaHJvbm91c19yYW5kb21fdmFsdWVzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxvRUFBb0U7QUFDcEUsc0NBQXNDOzs7QUFFdEMsK0RBQXVEO0FBQ3ZELHlFQUFzRTtBQUN0RSxvRUFBMEQ7QUFFMUQ7OztHQUdHO0FBQ1UsUUFBQSx1QkFBdUIsR0FBRywrQkFBK0IsQ0FDcEUsSUFBQSxpQ0FBWSxHQUFFLENBQ2YsQ0FBQTtBQUVELFNBQWdCLCtCQUErQixDQUM3QyxXQUFtQjtJQUVuQixPQUFPLFNBQVMsdUJBQXVCLENBQUMsVUFBa0I7UUFDeEQsSUFBSSxJQUFBLDBDQUFvQixFQUFDLFdBQVcsQ0FBQyxFQUFFO1lBQ3JDLE9BQU8sV0FBVyxDQUFDLE1BQU0sQ0FBQyxlQUFlLENBQUMsSUFBSSxVQUFVLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQTtTQUN0RTthQUFNLElBQUksSUFBQSwyQkFBVSxFQUFDLFdBQVcsQ0FBQyxFQUFFO1lBQ2xDLE1BQU0sTUFBTSxHQUFHLElBQUksVUFBVSxDQUFDLFVBQVUsQ0FBQyxDQUFBO1lBQ3pDLFdBQVcsQ0FBQyxRQUFRLENBQUMsZUFBZSxDQUFDLE1BQU0sQ0FBQyxDQUFBO1lBQzVDLE9BQU8sTUFBTSxDQUFBO1NBQ2Q7UUFFRCxNQUFNLElBQUksS0FBSyxDQUFDLDBDQUEwQyxDQUFDLENBQUE7SUFDN0QsQ0FBQyxDQUFBO0FBQ0gsQ0FBQztBQWRELDBFQWNDIn0=