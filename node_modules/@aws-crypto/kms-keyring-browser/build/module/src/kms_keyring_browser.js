// Copyright Amazon.com Inc. or its affiliates. All Rights Reserved.
// SPDX-License-Identifier: Apache-2.0
import { KmsKeyringClass, getClient, limitRegions, excludeRegions, cacheClients, } from '@aws-crypto/kms-keyring';
import { immutableClass, importForWebCryptoEncryptionMaterial, importForWebCryptoDecryptionMaterial, KeyringWebCrypto, } from '@aws-crypto/material-management-browser';
import { KMS } from 'aws-sdk';
import { version } from './version';
const getKmsClient = getClient(KMS, {
    customUserAgent: `AwsEncryptionSdkJavascriptBrowser/${version}`,
});
const cacheKmsClients = cacheClients(getKmsClient);
export class KmsKeyringBrowser extends KmsKeyringClass(KeyringWebCrypto) {
    constructor({ clientProvider = cacheKmsClients, keyIds, generatorKeyId, grantTokens, discovery, } = {}) {
        super({ clientProvider, keyIds, generatorKeyId, grantTokens, discovery });
    }
    async _onEncrypt(material) {
        const _material = await super._onEncrypt(material);
        return importForWebCryptoEncryptionMaterial(_material);
    }
    async _onDecrypt(material, encryptedDataKeys) {
        const _material = await super._onDecrypt(material, encryptedDataKeys);
        return importForWebCryptoDecryptionMaterial(_material);
    }
}
immutableClass(KmsKeyringBrowser);
export { getClient, cacheKmsClients, getKmsClient, limitRegions, excludeRegions, cacheClients, KMS, };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoia21zX2tleXJpbmdfYnJvd3Nlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9rbXNfa2V5cmluZ19icm93c2VyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLG9FQUFvRTtBQUNwRSxzQ0FBc0M7QUFFdEMsT0FBTyxFQUNMLGVBQWUsRUFJZixTQUFTLEVBQ1QsWUFBWSxFQUNaLGNBQWMsRUFDZCxZQUFZLEdBQ2IsTUFBTSx5QkFBeUIsQ0FBQTtBQUNoQyxPQUFPLEVBS0wsY0FBYyxFQUNkLG9DQUFvQyxFQUNwQyxvQ0FBb0MsRUFDcEMsZ0JBQWdCLEdBRWpCLE1BQU0seUNBQXlDLENBQUE7QUFDaEQsT0FBTyxFQUFFLEdBQUcsRUFBRSxNQUFNLFNBQVMsQ0FBQTtBQUM3QixPQUFPLEVBQUUsT0FBTyxFQUFFLE1BQU0sV0FBVyxDQUFBO0FBQ25DLE1BQU0sWUFBWSxHQUFHLFNBQVMsQ0FBQyxHQUFHLEVBQUU7SUFDbEMsZUFBZSxFQUFFLHFDQUFxQyxPQUFPLEVBQUU7Q0FDaEUsQ0FBQyxDQUFBO0FBQ0YsTUFBTSxlQUFlLEdBQUcsWUFBWSxDQUFDLFlBQVksQ0FBQyxDQUFBO0FBU2xELE1BQU0sT0FBTyxpQkFBa0IsU0FBUSxlQUFlLENBR3BELGdCQUE2QyxDQUFDO0lBQzlDLFlBQVksRUFDVixjQUFjLEdBQUcsZUFBZSxFQUNoQyxNQUFNLEVBQ04sY0FBYyxFQUNkLFdBQVcsRUFDWCxTQUFTLE1BQ21CLEVBQUU7UUFDOUIsS0FBSyxDQUFDLEVBQUUsY0FBYyxFQUFFLE1BQU0sRUFBRSxjQUFjLEVBQUUsV0FBVyxFQUFFLFNBQVMsRUFBRSxDQUFDLENBQUE7SUFDM0UsQ0FBQztJQUVELEtBQUssQ0FBQyxVQUFVLENBQUMsUUFBcUM7UUFDcEQsTUFBTSxTQUFTLEdBQUcsTUFBTSxLQUFLLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxDQUFBO1FBRWxELE9BQU8sb0NBQW9DLENBQUMsU0FBUyxDQUFDLENBQUE7SUFDeEQsQ0FBQztJQUVELEtBQUssQ0FBQyxVQUFVLENBQ2QsUUFBcUMsRUFDckMsaUJBQXFDO1FBRXJDLE1BQU0sU0FBUyxHQUFHLE1BQU0sS0FBSyxDQUFDLFVBQVUsQ0FBQyxRQUFRLEVBQUUsaUJBQWlCLENBQUMsQ0FBQTtRQUVyRSxPQUFPLG9DQUFvQyxDQUFDLFNBQVMsQ0FBQyxDQUFBO0lBQ3hELENBQUM7Q0FDRjtBQUNELGNBQWMsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFBO0FBRWpDLE9BQU8sRUFDTCxTQUFTLEVBQ1QsZUFBZSxFQUNmLFlBQVksRUFDWixZQUFZLEVBQ1osY0FBYyxFQUNkLFlBQVksRUFDWixHQUFHLEdBQ0osQ0FBQSJ9