"use strict";
// Copyright Amazon.com Inc. or its affiliates. All Rights Reserved.
// SPDX-License-Identifier: Apache-2.0
Object.defineProperty(exports, "__esModule", { value: true });
exports.KMS = exports.cacheClients = exports.excludeRegions = exports.limitRegions = exports.getKmsClient = exports.cacheKmsClients = exports.getClient = exports.KmsKeyringBrowser = void 0;
const kms_keyring_1 = require("@aws-crypto/kms-keyring");
Object.defineProperty(exports, "getClient", { enumerable: true, get: function () { return kms_keyring_1.getClient; } });
Object.defineProperty(exports, "limitRegions", { enumerable: true, get: function () { return kms_keyring_1.limitRegions; } });
Object.defineProperty(exports, "excludeRegions", { enumerable: true, get: function () { return kms_keyring_1.excludeRegions; } });
Object.defineProperty(exports, "cacheClients", { enumerable: true, get: function () { return kms_keyring_1.cacheClients; } });
const material_management_browser_1 = require("@aws-crypto/material-management-browser");
const aws_sdk_1 = require("aws-sdk");
Object.defineProperty(exports, "KMS", { enumerable: true, get: function () { return aws_sdk_1.KMS; } });
const version_1 = require("./version");
const getKmsClient = (0, kms_keyring_1.getClient)(aws_sdk_1.KMS, {
    customUserAgent: `AwsEncryptionSdkJavascriptBrowser/${version_1.version}`,
});
exports.getKmsClient = getKmsClient;
const cacheKmsClients = (0, kms_keyring_1.cacheClients)(getKmsClient);
exports.cacheKmsClients = cacheKmsClients;
class KmsKeyringBrowser extends (0, kms_keyring_1.KmsKeyringClass)(material_management_browser_1.KeyringWebCrypto) {
    constructor({ clientProvider = cacheKmsClients, keyIds, generatorKeyId, grantTokens, discovery, } = {}) {
        super({ clientProvider, keyIds, generatorKeyId, grantTokens, discovery });
    }
    async _onEncrypt(material) {
        const _material = await super._onEncrypt(material);
        return (0, material_management_browser_1.importForWebCryptoEncryptionMaterial)(_material);
    }
    async _onDecrypt(material, encryptedDataKeys) {
        const _material = await super._onDecrypt(material, encryptedDataKeys);
        return (0, material_management_browser_1.importForWebCryptoDecryptionMaterial)(_material);
    }
}
exports.KmsKeyringBrowser = KmsKeyringBrowser;
(0, material_management_browser_1.immutableClass)(KmsKeyringBrowser);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoia21zX2tleXJpbmdfYnJvd3Nlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9rbXNfa2V5cmluZ19icm93c2VyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxvRUFBb0U7QUFDcEUsc0NBQXNDOzs7QUFFdEMseURBU2dDO0FBMEQ5QiwwRkE5REEsdUJBQVMsT0E4REE7QUFHVCw2RkFoRUEsMEJBQVksT0FnRUE7QUFDWiwrRkFoRUEsNEJBQWMsT0FnRUE7QUFDZCw2RkFoRUEsMEJBQVksT0FnRUE7QUE5RGQseUZBVWdEO0FBQ2hELHFDQUE2QjtBQW9EM0Isb0ZBcERPLGFBQUcsT0FvRFA7QUFuREwsdUNBQW1DO0FBQ25DLE1BQU0sWUFBWSxHQUFHLElBQUEsdUJBQVMsRUFBQyxhQUFHLEVBQUU7SUFDbEMsZUFBZSxFQUFFLHFDQUFxQyxpQkFBTyxFQUFFO0NBQ2hFLENBQUMsQ0FBQTtBQTRDQSxvQ0FBWTtBQTNDZCxNQUFNLGVBQWUsR0FBRyxJQUFBLDBCQUFZLEVBQUMsWUFBWSxDQUFDLENBQUE7QUEwQ2hELDBDQUFlO0FBakNqQixNQUFhLGlCQUFrQixTQUFRLElBQUEsNkJBQWUsRUFHcEQsOENBQTZDLENBQUM7SUFDOUMsWUFBWSxFQUNWLGNBQWMsR0FBRyxlQUFlLEVBQ2hDLE1BQU0sRUFDTixjQUFjLEVBQ2QsV0FBVyxFQUNYLFNBQVMsTUFDbUIsRUFBRTtRQUM5QixLQUFLLENBQUMsRUFBRSxjQUFjLEVBQUUsTUFBTSxFQUFFLGNBQWMsRUFBRSxXQUFXLEVBQUUsU0FBUyxFQUFFLENBQUMsQ0FBQTtJQUMzRSxDQUFDO0lBRUQsS0FBSyxDQUFDLFVBQVUsQ0FBQyxRQUFxQztRQUNwRCxNQUFNLFNBQVMsR0FBRyxNQUFNLEtBQUssQ0FBQyxVQUFVLENBQUMsUUFBUSxDQUFDLENBQUE7UUFFbEQsT0FBTyxJQUFBLGtFQUFvQyxFQUFDLFNBQVMsQ0FBQyxDQUFBO0lBQ3hELENBQUM7SUFFRCxLQUFLLENBQUMsVUFBVSxDQUNkLFFBQXFDLEVBQ3JDLGlCQUFxQztRQUVyQyxNQUFNLFNBQVMsR0FBRyxNQUFNLEtBQUssQ0FBQyxVQUFVLENBQUMsUUFBUSxFQUFFLGlCQUFpQixDQUFDLENBQUE7UUFFckUsT0FBTyxJQUFBLGtFQUFvQyxFQUFDLFNBQVMsQ0FBQyxDQUFBO0lBQ3hELENBQUM7Q0FDRjtBQTVCRCw4Q0E0QkM7QUFDRCxJQUFBLDRDQUFjLEVBQUMsaUJBQWlCLENBQUMsQ0FBQSJ9